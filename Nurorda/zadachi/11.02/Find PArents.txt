void dfs(int v);
route(++len)=v;
if(first[v])first[v]=len;
else a[len]=a[first[v]];
for(int i=0...g[v].size..)
dfs(g[v][i]);
route[++len]=v;
if(!first[v])first[v]=len,a[len]=++timer;
else d[len]=a[first[v]];